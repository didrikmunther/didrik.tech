(this.webpackJsonpsound3=this.webpackJsonpsound3||[]).push([[0],{34:function(e,t,n){e.exports=n(42)},39:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(27),o=n.n(c),l=(n(39),n(1)),u=n(2),i=n(3),s=n(10),d=n(6);function m(){var e=Object(u.a)(["\n    margin: 15px;\n    padding: 15px;\n    border-radius: 3px;\n    background: rgba(150, 150, 150, .5);\n    display: inline-block;\n    color: #ddd;\n\n    h1, h2, h3 {\n        margin: 0;\n    }\n\n    label {\n        > span {\n            display: block;\n            color: #eee;\n            padding: 5px;\n        }\n        > input, select {\n            margin-bottom: 15px;\n        }\n    }\n"]);return m=function(){return e},e}var f,b,v=i.a.div(m()),p=n(18),E=(f=0,b=8,Array(b-f+1).fill(0).map((function(e,t){return f+t}))).map((function(e){return[e,e-4]})),g=[["C",-9],["C#",-8],["Db",-8],["D",-7],["D#",-6],["Eb",-6],["E",-5],["F",-4],["F#",-3],["Gb",-3],["G",-2],["G#",-1],["Ab",-1],["A",0],["A#",1],["Bb",1],["B",2]],O=Object.entries(E.reduce((function(e,t){var n=Object(l.a)(t,2),a=n[0],r=n[1];return g.reduce((function(e,t){var n=Object(l.a)(t,2),c=n[0],o=n[1];return Object(d.a)(Object(d.a)({},e),{},Object(p.a)({},c+a,440*Math.pow(2,(o+12*r)/12)))}),e)}),{})).reverse().filter((function(e,t,n){var a=Object(l.a)(e,2),r=(a[0],a[1]);return n.findIndex((function(e){return Object(l.a)(e,2)[1]===r}))===t})).reverse().reduce((function(e,t){var n=Object(l.a)(t,2),a=n[0],r=n[1];return Object(d.a)(Object(d.a)({},e),{},Object(p.a)({},a,r))}),{}),j=n(44);function h(){var e=Object(u.a)(["\n    padding: 10px 20px;\n    border: 1px solid black;\n    border-radius: 3px;\n    background: #8a8a8a;\n    color: #efefef;\n    font-weight: 800;\n    font-size: 16px;\n"]);return h=function(){return e},e}function w(){var e=Object(u.a)(["\n    display: flex;\n    flex-direction: column;\n"]);return w=function(){return e},e}function y(){var e=Object(u.a)(["\n    display: flex;\n    align-items: center;\n    margin-bottom: 10px;\n"]);return y=function(){return e},e}var S=i.a.div(y()),x=(i.a.div(w()),i.a.button(h())),k=function(e,t,n){return.5*n-t*e},T=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"],C=function(e,t,n){var a=n,r=Math.log(a/t)/Math.LN2;return Math.pow(2,r*(e-1))*a},A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return C(t,n,.5*e.sampleRate)},R=r.a.createContext(new j.a(null)),N=function(e){return 0===e?0:C(e,.01,1e3)},L=function(e){var t=e.audio,n=Object(a.useContext)(R),c=Object(a.useState)(!1),o=Object(l.a)(c,2),u=o[0],i=o[1],s=Object(a.useState)(),d=Object(l.a)(s,2),m=d[0],f=d[1],b=$(.5,{min:0,max:1}),p=Object(l.a)(b,2),E=p[0],g=p[1],O=$(.1,{min:0,max:1,step:.001}),j=Object(l.a)(O,2),h=j[0],w=j[1],y=Object(a.useState)("sine"),x=Object(l.a)(y,2),k=x[0],T=x[1],C=Object(a.useState)(new OscillatorNode(t)),L=Object(l.a)(C,1)[0],D=Object(a.useState)(new GainNode(t)),G=Object(l.a)(D,1)[0];Object(a.useEffect)((function(){L.start()}),[L]),Object(a.useEffect)((function(){return L.type=k,L.frequency.setValueAtTime(A(t,E,.1),t.currentTime),G.gain.setValueAtTime(N(h),t.currentTime),L.connect(G),function(){L.frequency.cancelScheduledValues(t.currentTime),G.gain.cancelScheduledValues(t.currentTime),[function(){return L.disconnect(G)}].forEach(ie)}}),[t,L,G,E,k,h]);var I=Object(a.useCallback)((function(e){i(!0);var t=!1,a=[e.clientX,e.clientY];f([0,0]);var r=function(e){t||(t=!0,n.next(G)),e.preventDefault();var r=[e.clientX-a[0],e.clientY-a[1]];f(r)};document.addEventListener("mouseup",(function e(){document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",r),i(!1),t&&n.next(null)})),document.addEventListener("mousemove",r)}),[n,G]),V={};return u&&m&&(V={transform:"translate(".concat(m[0],"px, ").concat(m[1],"px)")}),r.a.createElement(v,null,r.a.createElement("h3",null,"LFO (drag and drop)"),r.a.createElement(v,{style:V,onMouseDown:I},r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Form ",r.a.createElement("b",null,k)),r.a.createElement("select",{value:k,onChange:function(e){return T(e.target.value)}},r.a.createElement("option",{value:"sine"},"Sine"),r.a.createElement("option",{value:"triangle"},"Triangle"),r.a.createElement("option",{value:"square"},"Square"),r.a.createElement("option",{value:"sawtooth"},"Sawtooth")))),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Frequency: ",A(t,E,.1).toFixed(1)),g),r.a.createElement("label",null,r.a.createElement("span",null,"Gain: ",N(h).toFixed(Math.log10(100))),w))))};function D(){var e=Object(u.a)(["\n    position: relative;\n    width: 75px;\n    height: 75px;\n    border-radius: 100%;\n    background: url('./resources/knob.png');\n    background-position: center center;\n    background-size: contain;\n"]);return D=function(){return e},e}function G(){var e=Object(u.a)(["\n    width: 10px;\n    height: 10px;\n    border-radius: 100%;\n    background: blue;\n    cursor: pointer;\n    opacity: .8;\n    &:hover {\n        opacity: 1;\n    }\n"]);return G=function(){return e},e}function I(){var e=Object(u.a)(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    color: black;\n"]);return I=function(){return e},e}function V(){var e=Object(u.a)(["\n    position: relative;\n"]);return V=function(){return e},e}function F(){var e=Object(u.a)(["\n    position: relative;\n    display: inline-block;\n    margin: 5px;\n    &:after {\n        ","\n    }\n"]);return F=function(){return e},e}var q=function(e,t){return e[0]>t.x&&e[0]<t.x+t.width&&e[1]>t.y&&e[1]<t.y+t.height},M=i.a.div(F(),(function(e){return e.active&&"\n            content: '';\n            top: 0;\n            left: 0;\n            position: absolute;\n            width: 100%;\n            height: 100%;\n            border-radius: 3px;\n            background-color: rgba(150, 150, 150, .5);\n        "})),$=function(e){var t,n,c,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=Object(a.useState)(e),i=Object(l.a)(u,2),d=i[0],m=i[1],f=Object(a.useState)(!1),b=Object(l.a)(f,2),v=b[0],p=b[1],E=Object(a.useState)([]),g=Object(l.a)(E,2),O=g[0],j=g[1],h=Object(a.useRef)(null),w=Object(a.useContext)(R);Object(a.useEffect)((function(){if(o.bind){var e=w.subscribe((function(e){if(h.current&&(p(!!e),e)){var t=h.current;document.addEventListener("mouseup",(function n(a){if(document.removeEventListener("mouseup",n),q([a.clientX,a.clientY],t.getBoundingClientRect())){if(!o.bind)return;e.connect(o.bind),j((function(t){return[].concat(Object(s.a)(t),[{lfo:e,remove:function(){j((function(t){return t.filter((function(t){return t.lfo!==e}))})),o.bind&&e.disconnect(o.bind)}}])}))}}))}}));return function(){return e.unsubscribe()}}}),[w,p,o.bind,h,j]);var y=r.a.createElement(M,{ref:h,active:v},r.a.createElement(P,{initialValue:d,onChange:function(e){return m(e)},min:null!==(t=o.min)&&void 0!==t?t:0,max:null!==(n=o.max)&&void 0!==n?n:1,step:null!==(c=o.step)&&void 0!==c?c:.01,lfos:O}));return[d,y,m]},P=function(e){var t=e.onChange,n=e.factor,c=void 0===n?.01:n,o=e.min,u=void 0===o?-1:o,i=e.max,s=void 0===i?1:i,d=e.initialValue,m=e.step,f=void 0===m?.01:m,b=e.lfos,v=void 0===b?[]:b,p=Object(a.useState)(d),E=Object(l.a)(p,2),g=E[0],O=E[1],j=Object(a.useRef)(null),h=Object(a.useCallback)((function(e){e.stopPropagation();var n=[e.screenX,e.screenY],a=0,r=function(e){e.preventDefault();var r=[e.screenX,e.screenY];a=c*Math.abs(s-u)*(n[1]-r[1]);var o=Math.round(1*(g+a)/f)/(1/f);o>s?o=s:o<u&&(o=u),O(o),t(o)};document.addEventListener("mouseup",(function e(t){document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",r)})),document.addEventListener("mousemove",r)}),[c,s,u,t,f,O,g]),w=220*(g-u)/Math.abs(s-u)-110,y={transform:"rotate(".concat(w,"deg)")};return r.a.createElement(z,null,r.a.createElement(B,null,v.map((function(e,t){return r.a.createElement(H,{key:t,onClick:function(t){return e.remove()}})}))),r.a.createElement(_,{ref:j,onMouseDown:h,style:y}))},z=i.a.div(V()),B=i.a.div(I()),H=i.a.div(G()),_=i.a.div(D()),W=n(4),Q=n(45),X=n(31);function Y(){var e=Object(u.a)(["\n    display: flex;\n    align-items: center;\n"]);return Y=function(){return e},e}var J,U=i.a.div(Y()),K=function(e){var t=e.compressor,n=Object(a.useRef)(null);Object(a.useEffect)((function(){if(n.current){var e=n.current,a=e.width,r=e.height,c=n.current.getContext("2d");if(c&&(c.clearRect(0,0,a,r),c.font="30px Arial",t)){var o=!0;return function e(){if(o){requestAnimationFrame(e),c.clearRect(0,0,a,r);var n=t.reduction/-60;c.fillStyle="rgb("+(255*n+50)+",50,50)",c.fillRect(0,0,a*n,r)}}(),function(){o=!1}}}}),[t,n]);return r.a.createElement(U,null,r.a.createElement("canvas",{ref:n,style:{width:100,height:10}}))},Z=["Block Inside.wav","Bottle Hall.wav","Cement Blocks 1.wav","Cement Blocks 2.wav","Chateau de Logne, Outside.wav","Conic Long Echo Hall.wav","Deep Space.wav","Derlon Sanctuary.wav","Direct Cabinet N1.wav","Direct Cabinet N2.wav","Direct Cabinet N3.wav","Direct Cabinet N4.wav","Five Columns Long.wav","Five Columns.wav","French 18th Century Salon.wav","Going Home.wav","Greek 7 Echo Hall.wav","Highly Damped Large Room.wav","In The Silo Revised.wav","In The Silo.wav","Large Bottle Hall.wav","Large Long Echo Hall.wav","Large Wide Echo Hall.wav","Masonic Lodge.wav","Musikvereinsaal.wav","Narrow Bumpy Space.wav","Nice Drum Room.wav","On a Star.wav","Parking Garage.wav","Rays.wav","Right Glass Triangle.wav","Ruby Room.wav","Scala Milan Opera Hall.wav","Small Drum Room.wav","Small Prehistoric Cave.wav","St Nicolaes Church.wav","Trig Room.wav","Vocal Duo.wav"].map((function(e){return e.slice(0,e.length-4)}));function ee(){var e=Object(u.a)(["\n    padding: 5px;\n    margin-bottom: 2px;\n    border-radius: 3px;\n    background: #007ea7;\n    position: relative;\n\n    &:first-child {\n        margin-bottom: 10px;\n        &:after {\n            content: '';\n            display: block;\n            position: absolute;\n            border-bottom: 1px solid #444;\n            width: 100%;\n            height: 1px;\n            left: 0;\n            bottom: -5px;\n        }\n    }\n\n    cursor: pointer;\n    opacity: .8;\n    &:hover {\n        opacity: 1;\n    }\n"]);return ee=function(){return e},e}function te(){var e=Object(u.a)(["\n    position: absolute;\n    border: 1px solid black;\n    border-radius: 3px;\n    z-index: 999;\n    overflow: hidden;\n\n    > "," {\n        margin: 0;\n    }\n"]);return te=function(){return e},e}function ne(){var e=Object(u.a)(["\n    border-radius: 100%;\n    background: red;\n    border: none;\n    width: 15px;\n    height: 15px;\n    overflow: hidden;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: white;\n    font-weight: bold;\n    font-size: 10px;\n    outline: none;\n    cursor: pointer;\n\n    opacity: .8;\n    &:hover {\n        opacity: 1;\n    }\n\n    &:before {\n        content: 'x';\n    }\n"]);return ne=function(){return e},e}function ae(){var e=Object(u.a)(["\n    background: #b2b2ff;\n    width: 100%;\n    height: 20px;\n    cursor: move;\n    display: flex;\n    align-items: center;\n    padding: 0 2px;\n"]);return ae=function(){return e},e}var re,ce=function(e){var t=localStorage.getItem(e);if(null!==t)try{var n;return null!==(n=JSON.parse(t))&&void 0!==n?n:void 0}catch(a){return}},oe={ES1:function(e){var t,n,c,o,u,i,d,m,f=e.audio,b=e.serialized$,p=e.initial,E=e.out,g=e.commands$,j=void 0===g?new W.a:g,h=Object(a.useState)(new GainNode(f)),w=Object(l.a)(h,1)[0],y=Object(a.useState)(null!==(t=p.mode)&&void 0!==t?t:"poly"),x=Object(l.a)(y,2),k=x[0],T=x[1],C=Object(a.useState)(null!==(n=p.form)&&void 0!==n?n:"sine"),A=Object(l.a)(C,2),R=A[0],N=A[1],L=$(null!==(c=p.release)&&void 0!==c?c:.2,{max:5}),D=Object(l.a)(L,2),G=D[0],I=D[1],V=$(null!==(o=p.attack)&&void 0!==o?o:.2,{max:5}),F=Object(l.a)(V,2),q=F[0],M=F[1],P=$(null!==(u=p.volume)&&void 0!==u?u:.2),z=Object(l.a)(P,2),B=z[0],H=z[1],_=$(null!==(i=p.glide)&&void 0!==i?i:.2,{max:5}),Q=Object(l.a)(_,2),X=Q[0],Y=Q[1],J=$(null!==(d=p.voices)&&void 0!==d?d:1,{min:1,max:16,step:1}),U=Object(l.a)(J,2),K=U[0],Z=U[1],ee=$(null!==(m=p.detune)&&void 0!==m?m:0),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],re=Object(a.useState)({}),ce=Object(l.a)(re,1)[0];Object(a.useEffect)((function(){w.connect(E),w.gain.setValueAtTime(1,f.currentTime)}),[f,E,w]),Object(a.useEffect)((function(){var e=j.subscribe((function(e){var t=e.note,n=e.velocity;if(console.log("ES1 received command",t,n),n<=0){var a=ce[t];if(!a)return;return a.playing=!1,a.env.gain.cancelScheduledValues(f.currentTime).setTargetAtTime(a.env.gain.value,f.currentTime,0).linearRampToValueAtTime(0,f.currentTime+G),void setTimeout((function(){a.osc.forEach((function(e){return e.stop(f.currentTime)})),a.gain.disconnect(w)}),1e3*G)}var r=f.createGain();r.gain.cancelScheduledValues(f.currentTime).setValueAtTime(0,f.currentTime).linearRampToValueAtTime(1,f.currentTime+q);var c=f.createGain();c.gain.setValueAtTime(B*n/127,f.currentTime);var o=Object(l.a)(Object.entries(O)[t],2)[1],u=Object(s.a)(Array(K)).map((function(e,t,n){var a=f.createStereoPanner();n.length>=2&&a.pan.setValueAtTime(2*t/n.length-1,f.currentTime);var l=f.createOscillator();return l.connect(r).connect(a).connect(c).connect(w),l.type=R,l.frequency.setValueAtTime(o,f.currentTime),l.detune.setValueAtTime(ne*(n.length/2-t),f.currentTime),l}));u.forEach((function(e){return e.start()})),ce[t]={playing:!0,velocity:n,osc:u,env:r,gain:c}}));return function(){return e.unsubscribe()}}),[f,j,ce,R,G,q,B,k,X,w,K,ne]);var oe=Object(a.useCallback)((function(e){return Object.values(ce).filter((function(e){return e.playing})).forEach(e)}),[ce]);Object(a.useEffect)((function(){oe((function(e){return e.gain.gain.setValueAtTime(B*e.velocity/127,f.currentTime)}))}),[f,oe,B]),Object(a.useEffect)((function(){oe((function(e){return e.osc.forEach((function(e,t,n){return e.detune.setValueAtTime(ne*(n.length/2-t),f.currentTime)}))}))}),[f,oe,ne]);var le={mode:k,form:R,release:G,attack:q,volume:B,glide:X,voices:K,detune:ne};return Object(a.useEffect)((function(){return b.next(le)}),Object.values(le)),r.a.createElement(v,null,r.a.createElement("h3",null,"Oscillator"),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Mode ",r.a.createElement("b",null,k)),r.a.createElement("select",{value:k,onChange:function(e){return T(e.target.value)}},r.a.createElement("option",{value:"poly"},"Poly"),r.a.createElement("option",{value:"mono"},"Mono"),r.a.createElement("option",{value:"legato"},"Legato"))),r.a.createElement("label",null,r.a.createElement("span",null,"Form ",r.a.createElement("b",null,R)),r.a.createElement("select",{value:R,onChange:function(e){return N(e.target.value)}},r.a.createElement("option",{value:"sine"},"Sine"),r.a.createElement("option",{value:"triangle"},"Triangle"),r.a.createElement("option",{value:"square"},"Square"),r.a.createElement("option",{value:"sawtooth"},"Sawtooth")))),r.a.createElement("label",null,r.a.createElement("span",null,"Volume: ",B),H),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Release: ",G),I),r.a.createElement("label",null,r.a.createElement("span",null,"Attack: ",q),M)),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Voices: ",K),Z),r.a.createElement("label",null,r.a.createElement("span",null,"Detune: ",ne),ae)),r.a.createElement("label",null,r.a.createElement("span",null,"Glide: ",X),Y))},Compressor:function(e){var t,n,c,o,u,i,s=e.audio,d=e.input,m=e.out,f=e.initial,b=e.serialized$,p=Object(a.useState)(null===(t=f.enabled)||void 0===t||t),E=Object(l.a)(p,2),g=E[0],O=E[1],j=Object(a.useState)(new DynamicsCompressorNode(s)),h=Object(l.a)(j,1)[0],w=$(null!==(n=f.threshold)&&void 0!==n?n:-50,{min:-100,max:0,bind:h.threshold}),y=Object(l.a)(w,2),x=y[0],k=y[1],T=$(null!==(c=f.knee)&&void 0!==c?c:40,{min:0,max:40,bind:h.knee}),C=Object(l.a)(T,2),A=C[0],R=C[1],N=$(null!==(o=f.ratio)&&void 0!==o?o:12,{min:1,max:20,bind:h.ratio}),L=Object(l.a)(N,2),D=L[0],G=L[1],I=$(null!==(u=f.attack)&&void 0!==u?u:0,{max:1,bind:h.attack}),V=Object(l.a)(I,2),F=V[0],q=V[1],M=$(null!==(i=f.release)&&void 0!==i?i:.25,{min:.01,bind:h.release}),P=Object(l.a)(M,2),z=P[0],B=P[1];Object(a.useEffect)((function(){return g?null===d||void 0===d||d.connect(h).connect(m):null===d||void 0===d||d.connect(m),function(){return[function(){return null===d||void 0===d?void 0:d.disconnect(h)},function(){return null===d||void 0===d?void 0:d.disconnect(m)},function(){return h.disconnect(m)}].forEach(ie)}}),[d,m,h,g]),Object(a.useEffect)((function(){h.threshold.setValueAtTime(x,s.currentTime),h.knee.setValueAtTime(A,s.currentTime),h.ratio.setValueAtTime(D,s.currentTime),h.attack.setValueAtTime(F,s.currentTime),h.release.setValueAtTime(z,s.currentTime)}),[s,h,x,A,D,F,z]);var H={enabled:g,threshold:x,knee:A,ratio:D,release:z,attack:F};return Object(a.useEffect)((function(){return b.next(H)}),Object.values(H)),r.a.createElement(v,null,r.a.createElement(S,null,r.a.createElement("h3",null,"Compressor"),r.a.createElement("input",{type:"checkbox",checked:g,onChange:function(e){return O(e.target.checked)}}),r.a.createElement(K,{compressor:g?h:void 0})),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Ratio: ",D),G)),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Threshold: ",x),k),r.a.createElement("label",null,r.a.createElement("span",null,"Knee: ",A),R)),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Release: ",z),B),r.a.createElement("label",null,r.a.createElement("span",null,"Attack: ",F),q)))},Reverb:function(e){var t,n,c=e.audio,o=e.input,u=e.out,i=e.serialized$,s=e.initial,d=Object(a.useState)(null===(t=s.enabled)||void 0===t||t),m=Object(l.a)(d,2),f=m[0],b=m[1],p=Object(a.useState)(new ConvolverNode(c)),E=Object(l.a)(p,1)[0],g=Object(a.useState)(null!==(n=s.impulse)&&void 0!==n?n:Z[0]),O=Object(l.a)(g,2),j=O[0],h=O[1],w=Object(a.useState)(),y=Object(l.a)(w,2),x=y[0],k=y[1],T=Object(a.useRef)(null);Object(a.useEffect)((function(){fetch("./resources/impulses/".concat(j,".wav")).then((function(e){return e.arrayBuffer()})).then((function(e){k(e.slice(0)),c.decodeAudioData(e,(function(e){return E.buffer=e}))}))}),[c,j,E]),Object(a.useEffect)((function(){return f?null===o||void 0===o||o.connect(E).connect(u):null===o||void 0===o||o.connect(u),function(){return[function(){return null===o||void 0===o?void 0:o.disconnect(u)},function(){return null===o||void 0===o?void 0:o.disconnect(E)},function(){return E.disconnect(u)}].forEach(ie)}}),[f,o,E,u]);var C={enabled:f,impulse:j};Object(a.useEffect)((function(){return i.next(C)}),Object.values(C));var A=Object(a.useCallback)((function(){if((null===T||void 0===T?void 0:T.current)&&x){var e=new Blob([x],{type:"audio/mp3"}),t=window.URL.createObjectURL(e);T.current.src=t,T.current.play()}}),[x]);return r.a.createElement(v,null,r.a.createElement(S,null,r.a.createElement("h3",null,"Reverb"),r.a.createElement("input",{type:"checkbox",checked:f,onChange:function(e){return b(e.target.checked)}})),r.a.createElement("audio",{ref:T,style:{display:"none"}}),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Impulse ",r.a.createElement("b",null,j)),r.a.createElement("select",{value:j,onChange:function(e){return h(e.target.value)}},Z.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)}))),r.a.createElement("button",{onClick:A},"Play sound"))))},EQ:function(e){var t,n,c,o,u,i,s=e.audio,d=e.initial,m=e.serialized$,f=(e.commands$,e.input),b=e.out,p=Object(a.useState)(null===(t=d.enabled)||void 0===t||t),E=Object(l.a)(p,2),g=E[0],O=E[1],j=Object(a.useState)(new BiquadFilterNode(s)),h=Object(l.a)(j,1)[0],w=Object(a.useRef)(null),y=$(null!==(n=d.frequency)&&void 0!==n?n:.5,{min:0,max:1,bind:h.frequency}),x=Object(l.a)(y,2),C=x[0],R=x[1],N=$(null!==(c=d.detune)&&void 0!==c?c:0,{min:0,max:100,bind:h.detune}),L=Object(l.a)(N,2),D=L[0],G=L[1],I=$(null!==(o=d.Q)&&void 0!==o?o:1,{min:1e-4,max:100,bind:h.Q}),V=Object(l.a)(I,2),F=V[0],q=V[1],M=$(null!==(u=d.gain)&&void 0!==u?u:0,{min:-40,max:40,bind:h.gain}),P=Object(l.a)(M,2),z=P[0],B=P[1],H=Object(a.useState)(null!==(i=d.biquadType)&&void 0!==i?i:"lowpass"),_=Object(l.a)(H,2),W=_[0],Q=_[1];Object(a.useEffect)((function(){if(w.current)return function(e,t,n){var a=n.getContext("2d");if(a){var r=n.width,c=n.height,o=!0;return function n(){if(o){requestAnimationFrame(n),a.clearRect(0,0,r,c),a.fillRect(0,0,r,c),a.strokeStyle="rgb(224,27,106)",a.lineWidth=3,a.beginPath(),a.moveTo(0,0);for(var l=.5*c/60,u=new Float32Array(r),i=new Float32Array(r),s=new Float32Array(r),d=.5*e.sampleRate,m=0;m<r;++m){var f=m/r;f=d*Math.pow(2,11*(f-1)),u[m]=f}for(t.getFrequencyResponse(u,i,s),m=0;m<r;++m){f=i[m];var b=i[m],v=20*Math.log(b)/Math.LN10,p=m,E=k(v,l,c);0===m?a.moveTo(p,E):a.lineTo(p,E)}a.stroke(),a.beginPath(),a.lineWidth=1,a.strokeStyle="rgb(100,100,100)";for(var g=0;g<=11;g++){p=g*r/11,a.strokeStyle="rgb(100,100,100)",a.moveTo(p,30),a.lineTo(p,c),a.stroke();var O=(f=d*Math.pow(2,g-11)).toFixed(0),j="Hz";f>1e3&&(j="KHz",O=(f/1e3).toFixed(1)),a.textAlign="center",a.strokeStyle="rgb(81,127,207)",a.strokeText(O+j,p,20)}a.beginPath(),a.moveTo(0,.5*c),a.lineTo(r,.5*c),a.stroke();for(var h=-60;h<50;h+=10)E=k(h,l,c),a.strokeStyle="rgb(81,127,207)",a.strokeText(h.toFixed(0)+"dB",r-40,E),a.strokeStyle="rgb(100,100,100)",a.beginPath(),a.moveTo(0,E),a.lineTo(r,E),a.stroke()}}(),function(){o=!1}}}(s,h,w.current)}),[s,h,w]),Object(a.useEffect)((function(){return g?null===f||void 0===f||f.connect(h).connect(b):null===f||void 0===f||f.connect(b),function(){return[function(){return null===f||void 0===f?void 0:f.disconnect(h)},function(){return null===f||void 0===f?void 0:f.disconnect(b)},function(){return h.disconnect(b)}].forEach(ie)}}),[f,h,b,g]),Object(a.useEffect)((function(){h.frequency.setValueAtTime(A(s,C),s.currentTime),h.detune.setValueAtTime(D,s.currentTime),h.Q.setValueAtTime(F,s.currentTime),h.gain.setValueAtTime(z,s.currentTime),h.type=W}),[s,C,D,F,z,W,h]);var X={frequency:C,detune:D,Q:F,gain:z,biquadType:W};return Object(a.useEffect)((function(){return m.next(X)}),Object.values(X)),r.a.createElement(v,null,r.a.createElement(S,null,r.a.createElement("h3",null,"EQ"),r.a.createElement("input",{type:"checkbox",checked:g,onChange:function(e){return O(e.target.checked)}})),r.a.createElement(S,null,r.a.createElement("canvas",{ref:w})),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("select",{value:W,onChange:function(e){return Q(e.target.value)}},T.map((function(e,t){return r.a.createElement("option",{key:t,value:e},e)})))),r.a.createElement("label",null,r.a.createElement("span",null,"Frequency: ",A(s,C).toFixed(0)),R)),r.a.createElement(S,null,r.a.createElement("label",null,r.a.createElement("span",null,"Detune: ",D),G),r.a.createElement("label",null,r.a.createElement("span",null,"Q: ",F),q),r.a.createElement("label",null,r.a.createElement("span",null,"Gain: ",z),B)))}};!function(e){e[e.CHANGE_SETTINGS=0]="CHANGE_SETTINGS",e[e.CHANGE_WRAPPER_SETTINGS=1]="CHANGE_WRAPPER_SETTINGS"}(re||(re={}));var le=function(e,t){switch(t.type){case re.CHANGE_SETTINGS:var n=e.vsts.findIndex((function(e){return e.id===t.id}));return n<0?Object(d.a)({},e):{vsts:[].concat(Object(s.a)(e.vsts.slice(0,n)),[Object(d.a)(Object(d.a)({},e.vsts[n]),{},{settings:t.payload})],Object(s.a)(e.vsts.slice(n+1)))};case re.CHANGE_WRAPPER_SETTINGS:var a=e.vsts.findIndex((function(e){return e.id===t.id}));return a<0?Object(d.a)({},e):{vsts:[].concat(Object(s.a)(e.vsts.slice(0,a)),[Object(d.a)(Object(d.a)({},e.vsts[a]),{},{wrapperSettings:t.payload})],Object(s.a)(e.vsts.slice(a+1)))};default:return e}},ue={vsts:[{id:0,pos:0,name:"ES1",wrapperSettings:{},settings:null!==(J=ce("ES1"))&&void 0!==J?J:{}},{id:1,pos:2,name:"Compressor",wrapperSettings:{},settings:{}},{id:2,pos:1,name:"Reverb",wrapperSettings:{},settings:{}},{id:3,pos:3,name:"EQ",wrapperSettings:{},settings:{}}]},ie=function(e){try{e()}catch(t){}},se=function(e){var t,n=e.audio,c=e.out,o=e.commands$,u=Object(a.useState)([]),i=Object(l.a)(u,2),m=i[0],f=i[1],b=Object(a.useState)(new j.a(null)),p=Object(l.a)(b,1)[0],E=Object(a.useReducer)(le,null!==(t=ce("SERIALIZED"))&&void 0!==t?t:ue),g=Object(l.a)(E,2),O=g[0],h=g[1],w=Object(a.useState)(!0),y=Object(l.a)(w,2),S=y[0],x=y[1],k=Object(a.useRef)(O);return Object(a.useEffect)((function(){k.current=O}),[O]),Object(a.useEffect)((function(){S?x(!1):localStorage.setItem("SERIALIZED",JSON.stringify(O))}),[S,O]),Object(a.useEffect)((function(){var e=void 0,t=Object.values(k.current.vsts).sort((function(e,t){return e.pos-t.pos})).map((function(t,a){var c=oe[t.name],l=n.createGain(),u=new j.a(t.settings),i=r.a.createElement(c,{key:a,audio:n,commands$:o,input:e,out:l,initial:t.settings,serialized$:u});e=l;var s=new j.a(t.wrapperSettings),m=r.a.createElement(de,{key:a,serialized$:s,initial:t.wrapperSettings,element:i},t.name);return{name:t.name,id:t.id,open:!1,element:i,wrapper:m,wrapperSerialized$:s.pipe(Object(X.a)((function(e){return Object(d.a)(Object(d.a)({},t),{},{wrapperSettings:e})}))),serialized$:u.pipe(Object(X.a)((function(e){return Object(d.a)(Object(d.a)({},t),{},{settings:e})}))),node:l}}));t[t.length-1].node.connect(c),f(t);var a=Q.a.apply(void 0,Object(s.a)(t.map((function(e){return e.serialized$})))).subscribe((function(e){h({type:re.CHANGE_SETTINGS,payload:e.settings,id:e.id})})),l=Q.a.apply(void 0,Object(s.a)(t.map((function(e){return e.wrapperSerialized$})))).subscribe((function(e){h({type:re.CHANGE_WRAPPER_SETTINGS,payload:e.wrapperSettings,id:e.id})}));return function(){t[t.length-1].node.disconnect(c),a.unsubscribe(),l.unsubscribe()}}),[n,o,c,k]),r.a.createElement(R.Provider,{value:p},r.a.createElement(v,null,m.map((function(e){return e.wrapper}))),r.a.createElement(L,{audio:n}))},de=function(e){var t,n,c=e.element,o=e.children,u=e.serialized$,i=e.initial,s=void 0===i?{}:i,m=Object(a.useState)(null!==(t=s.pos)&&void 0!==t?t:[0,0]),f=Object(l.a)(m,2),b=f[0],v=f[1],p=Object(a.useState)(null!==(n=s.open)&&void 0!==n&&n),E=Object(l.a)(p,2),g=E[0],O=E[1],j=Object(a.useCallback)((function(e){var t=e.target.getBoundingClientRect(),n=t.x,a=t.y,r=[e.clientX-n,e.clientY-a],c=function(e){e.preventDefault();var t=[e.clientX-r[0],e.clientY-r[1]];v(t),u.next({open:g,pos:t})};document.addEventListener("mouseup",(function e(t){document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",c)})),document.addEventListener("mousemove",c)}),[g,u]),h=Object(a.useCallback)((function(e){O((function(e){return!e})),u.next({open:!0,pos:b})}),[O,b,u]),w=Object(a.useCallback)((function(e){O(!1)}),[O]),y={display:g?"block":"none"};return b&&(y=Object(d.a)(Object(d.a)({},y),{},{left:b[0],top:b[1]})),r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{style:y},r.a.createElement(me,{onMouseDown:j},r.a.createElement(fe,{onClick:w})),c),r.a.createElement(ve,{onClick:h},o))},me=i.a.div(ae()),fe=i.a.button(ne()),be=i.a.div(te(),v),ve=i.a.div(ee());function pe(){var e=Object(u.a)(["\n    margin: 15px;\n    border-radius: 3px;\n    overflow: hidden;\n"]);return pe=function(){return e},e}var Ee=i.a.div(pe()),ge=function(e){var t=e.audio,n=e.out,c=Object(a.useState)(new AnalyserNode(t)),o=Object(l.a)(c,2),u=o[0],i=o[1],s=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(s.current){var e=s.current,a=e.getContext("2d");if(a){n.connect(u);var r=e.width,c=e.height;u.fftSize=2048;var o=u.fftSize,l=new Uint8Array(o);a.clearRect(0,0,r,c);var d=!0;return function t(){if(d){requestAnimationFrame(t),u.getByteTimeDomainData(l),a.fillStyle="rgb(0, 0, 0)",a.fillRect(0,0,r,c),a.lineWidth=2,a.strokeStyle="rgb(250, 250, 250)",a.beginPath();for(var n=1*r/o,i=0,s=0;s<o;s++){var m=l[s]/128*c/2;0===s?a.moveTo(i,m):a.lineTo(i,m),i+=n}a.lineTo(e.width,e.height/2),a.stroke()}}(),function(){d=!1,i(new AnalyserNode(t))}}}}),[t,s,u,n]),r.a.createElement(Ee,null,r.a.createElement("canvas",{ref:s}))},Oe=function(e){var t=e.audio,n=e.out,c=Object(a.useState)(new AnalyserNode(t)),o=Object(l.a)(c,2),u=o[0],i=o[1],s=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(s.current){var e=s.current,a=e.getContext("2d");if(a){n.connect(u);var r=e.width,c=e.height;u.fftSize=256;var o=u.frequencyBinCount,l=new Uint8Array(o);a.clearRect(0,0,r,c);var d=!0;return function e(){if(d){requestAnimationFrame(e),u.getByteFrequencyData(l),a.fillStyle="rgb(0, 0, 0)",a.fillRect(0,0,r,c);for(var t,n=r/o*2.5,i=0,s=0;s<o;s++)t=l[s],a.fillStyle="rgb("+(t+100)+",50,50)",a.fillRect(i,c-t/2,n,t/2),i+=n+1}}(),function(){d=!1,i(new AnalyserNode(t))}}}}),[t,n,s,u]),r.a.createElement(Ee,null,r.a.createElement("canvas",{ref:s}))},je=n(32),he=function(e){var t=e.commands$,n=function(){var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(),o=Object(l.a)(c,2),u=o[0],i=o[1];return Object(a.useEffect)((function(){navigator.requestMIDIAccess?navigator.requestMIDIAccess().then((function(e){return i(e)}),(function(e){return r(e)})):r("Midi not supported")}),[]),[u,n]}(),c=Object(l.a)(n,2),o=c[0],u=c[1],i=Object(a.useState)(),s=Object(l.a)(i,2),d=s[0],m=s[1],f=Object(a.useState)(),b=Object(l.a)(f,2),p=b[0],E=b[1],g=Object(a.useState)([]),O=Object(l.a)(g,2),j=O[0],h=O[1];return Object(a.useEffect)((function(){if(o){var e=function(){var e,t=[],n=Object(je.a)(o.inputs.values());try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(a)}}catch(r){n.e(r)}finally{n.f()}h(t)};o.onstatechange=function(t){console.log(t),m(t.port.manufacturer),E(t.port.name),e()},e()}}),[o,m,E,h]),Object(a.useEffect)((function(){j.forEach((function(e){e.onmidimessage=function(e){var n=Object(l.a)(e.data,2),a=n[0],r=n[1],c=e.data.length>2?e.data[2]:0,o=function(){return t.next({note:r,velocity:0})};switch(a){case 144:c>0?t.next({note:r,velocity:c}):o();break;case 128:o()}}}))}),[t,j]),!u&&j.length<=0?r.a.createElement(r.a.Fragment,null):u?r.a.createElement("h2",null,"MIDI error: ",u):r.a.createElement(v,null,r.a.createElement("h3",null,"Midi connected"),r.a.createElement("h4",null,d,": ",p))},we=n(33),ye={r:45,e:43,w:41,q:40,a:47,s:48,d:49,f:50,g:51,h:52,j:53,k:54,l:55,";":56,"'":57,"\\":58},Se=function(e){var t=e.commands$;return Object(a.useEffect)((function(){var e=function(e){if(!e.repeat){var n=ye[e.key.toLowerCase()];n&&(console.log("Playing note",n),t.next({note:n,velocity:127}))}},n=function(e){var n=ye[e.key.toLowerCase()];n&&(console.log("Releasing note",n),t.next({note:n,velocity:0}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",n),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",n)}}),[t]),r.a.createElement(r.a.Fragment,null)},xe=function(e){var t=e.commands$,n=Object(a.useState)(!1),c=Object(l.a)(n,2),o=c[0],u=c[1],i=Object(a.useState)(!1),d=Object(l.a)(i,2),m=d[0],f=d[1],b=Object(a.useRef)([]),p=Object(a.useState)(),E=Object(l.a)(p,2),g=E[0],O=E[1],j=Object(a.useState)([]),h=Object(l.a)(j,2),w=h[0],y=h[1];Object(a.useEffect)((function(){}),[t]);var S=Object(a.useCallback)((function(e){if(o)null===g||void 0===g||g.unsubscribe(),O(void 0);else{var n=Date.now();b.current=[];var a=t.subscribe((function(e){b.current.push({command:e,time:Date.now()-n})}));O(a)}u((function(e){return!e}))}),[u,o,O,t,g]),k=Object(a.useCallback)((function(e){if(u(!1),m)w.forEach(clearTimeout);else{var n;if((null===(n=b.current)||void 0===n?void 0:n.length)<=0)return;var a=[].concat(Object(s.a)(b.current.map((function(e){var n=e.time,a=e.command;return setTimeout((function(){t.next(a)}),n)}))),[setTimeout((function(){f(!1)}),b.current[b.current.length-1].time)]);y(a)}f((function(e){return!e}))}),[y,t,u,w,f,m]),T={};return o&&(T={background:"red"}),r.a.createElement(v,null,r.a.createElement(x,{style:T,onClick:S},o?"Stop recording":"Record"),r.a.createElement(x,{onClick:k},m?"Stop playing":"Play"))};function ke(){var e=Object(u.a)(["\n\theight: 100%;\n\tbackground-color: ",";\n\tbackground-size: 50px 50px;\n\tdisplay: flex;\n\talign-items: start;\n\tflex-wrap: wrap;\n\t> div {\n\t\tflex: 1 1 100%;\n\t}\n\t/* > * {\n\t\theight: 100%;\n\t\tmin-height: 100%;\n\t\twidth: 100%;\n\t} */\n\tbackground-image: linear-gradient(\n\t\t\t0deg,\n\t\t\ttransparent 24%,\n\t\t\t"," 25%,\n\t\t\t"," 26%,\n\t\t\ttransparent 27%,\n\t\t\ttransparent 74%,\n\t\t\t"," 75%,\n\t\t\t"," 76%,\n\t\t\ttransparent 77%,\n\t\t\ttransparent\n\t\t),\n\t\tlinear-gradient(\n\t\t\t90deg,\n\t\t\ttransparent 24%,\n\t\t\t"," 25%,\n\t\t\t"," 26%,\n\t\t\ttransparent 27%,\n\t\t\ttransparent 74%,\n\t\t\t"," 75%,\n\t\t\t"," 76%,\n\t\t\ttransparent 77%,\n\t\t\ttransparent\n\t\t);\n"]);return ke=function(){return e},e}var Te=i.a.div(ke(),(function(e){return e.background}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color}),(function(e){return e.color})),Ce=function(e){return r.a.createElement(Te,{background:e.background||"rgb(60, 60, 60)",color:e.color||"rgba(255,255,255, 0.05)"},e.children)},Ae=function(){var e=Object(a.useState)(new AudioContext),t=Object(l.a)(e,1)[0],n=Object(a.useState)(t.createAnalyser()),c=Object(l.a)(n,1)[0];Object(a.useEffect)((function(){var e=localStorage.getItem("STORAGE_VERSION");"1.3"!==e&&(console.log("".concat(e," != ").concat("1.3",", clearing localStorage")),localStorage.clear()),localStorage.setItem("STORAGE_VERSION","1.3")}),[]),Object(a.useEffect)((function(){return c.connect(t.destination),function(){return c.disconnect(t.destination)}}),[t,c]);var o=Object(a.useState)(new we.a),u=Object(l.a)(o,1)[0];return r.a.createElement(Ce,null,r.a.createElement(S,null,r.a.createElement(x,{style:{margin:"20px 0 0 20px"},onClick:function(){localStorage.clear(),window.location.reload()}},"Reset"),r.a.createElement(Se,{commands$:u}),r.a.createElement(he,{commands$:u})),r.a.createElement(S,null,r.a.createElement(xe,{commands$:u})),r.a.createElement(S,null,r.a.createElement(Oe,{audio:t,out:c}),r.a.createElement(ge,{audio:t,out:c})),r.a.createElement(S,null,r.a.createElement(se,{audio:t,commands$:u,out:c})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.596ddc57.chunk.js.map